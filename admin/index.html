<!DOCTYPE html>
<html>
<head>
    <title>Admin Control | Well Done Construction</title>
    <style>
        body { font-family: sans-serif; background: #F4F7F6; padding: 40px; color: #343E47; }
        .container { max-width: 800px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { text-align: left; padding: 12px; border-bottom: 1px solid #eee; }
        .btn-verify { background: #33B26E; color: white; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; }
        .status-v { color: #33B26E; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h2>WDC Applicant Review</h2>
        <button onclick="loadApplicants()" style="padding: 10px;">Refresh List</button>
        <table id="applicantTable">
            <thead>
                <tr>
                    <th>Email / Folder</th>
                    <th>Status</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody id="listBody">
                <tr><td colspan="3">Click Refresh to load applicants...</td></tr>
            </tbody>
        </table>
    </div>

    <script>
        const adminUrl = "YOUR_APPS_SCRIPT_URL_HERE";

        function loadApplicants() {
            const body = document.getElementById('listBody');
            body.innerHTML = "Loading...";
            
            const script = document.createElement('script');
            script.src = adminUrl + "?adminAction=list";
            document.body.appendChild(script);
        }

        function adminCallback(data) {
            const body = document.getElementById('listBody');
            body.innerHTML = "";
            data.forEach(person => {
                const row = `<tr>
                    <td>${person.name}</td>
                    <td class="${person.verified ? 'status-v' : ''}">${person.verified ? 'Verified' : 'Pending'}</td>
                    <td>
                        ${person.verified ? '' : `<button class="btn-verify" onclick="verifyUser('${person.id}')">Approve & Verify</button>`}
                    </td>
                </tr>`;
                body.innerHTML += row;
            });
        }

        function verifyUser(folderId) {
            if(!confirm("Approve this employee? This unlocks their portal.")) return;
            const script = document.createElement('script');
            script.src = adminUrl + "?adminAction=verify&folderId=" + folderId;
            document.body.appendChild(script);
        }

        function verifyDone() {
            alert("Employee Verified!");
            loadApplicants();
        }
    </script>
</body>
</html>
