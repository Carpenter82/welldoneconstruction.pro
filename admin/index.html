// ... existing head and styles ...
<script>
  const scriptURL = 'https://script.google.com/macros/s/AKfycbyN1uUGRDmEYax-dyv5VB5xpzYGfKdQ8by-uMq82eBBUFjk3ETj9juCd9ax6E5IzWMt/exec';

  async function loadWorkers() {
    try {
      const resp = await fetch(`${scriptURL}?action=getWorkers&t=${Date.now()}`);
      const workers = await resp.json();
      let html = '';

      workers.forEach(w => {
        const isPaused = w.status === 'PAUSED' || w.status === 'ON HOLD';
        html += `
          <div class="worker-card ${isPaused ? 'status-hold' : 'status-active'}">
            <div class="worker-info">
              <h3>${w.name}</h3>
              <p class="worker-meta"><strong>${w.trade}</strong> | <span class="badge">${w.status}</span> | Tier: ${w.tier || 'TBD'}</p>
              <p class="worker-email" style="font-size: 0.8rem; color: #999;">${w.email}</p>
            </div>
            <div class="worker-actions">
              <a href="projects.html?worker=${encodeURIComponent(w.email)}" class="btn-sm btn-projects">üìã Projects</a>
              <button onclick="assignWork('${w.email}')" class="btn-sm">Assign</button>
              <a href="${w.folderLink}" target="_blank" class="btn-sm">Files</a>
              <button onclick="updateStatus(${w.rowIndex}, '${isPaused ? 'ACTIVE' : 'PAUSED'}')" class="btn-sm toggle-btn">
                ${isPaused ? '‚ñ∂Ô∏è Resume' : '‚è∏Ô∏è Pause'}
              </button>
            </div>
          </div>`;
      });
      document.getElementById('workerList').innerHTML = html || '<p>No workers found.</p>';
    } catch (e) {
      document.getElementById('workerList').innerHTML = '<p style="color:red;">Error loading roster.</p>';
    }
  }

  async function updateStatus(row, newStatus) {
    if(!confirm(`Set status to ${newStatus}?`)) return;
    try {
      await fetch(scriptURL, {
        method: 'POST',
        mode: 'no-cors',
        body: JSON.stringify({ action: 'updateStatus', row: row, status: newStatus })
      });
      setTimeout(loadWorkers, 1000);
    } catch (e) { alert("Update failed."); }
  }

  async function assignWork(email) {
    const client = prompt("Client Name:");
    const address = prompt("Street Address:");
    const scope = prompt("Description / Scope:");
    const budget = prompt("Budget ($):");
    if (!client || !address) return;

    try {
      await fetch(scriptURL, {
        method: 'POST',
        mode: 'no-cors',
        body: JSON.stringify({ 
          action: 'assignWork', email: email, clientName: client, location: address, scope: scope, budget: budget, source: "Admin Dashboard", notes: "Direct Assignment" 
        })
      });
      alert("Job assigned!");
      window.location.href = `projects.html?worker=${encodeURIComponent(email)}`;
    } catch (e) { alert("Error assigning job."); }
  }
  window.onload = loadWorkers;
</script>
