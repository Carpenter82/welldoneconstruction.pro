<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>WD | Admin</title>
    <style>
        body { font-family: sans-serif; background: #1a1d20; color: white; padding: 20px; }
        .box { background: #2b3035; padding: 20px; border-radius: 8px; border-top: 4px solid #33B26E; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { text-align: left; border-bottom: 2px solid #444; padding: 10px; color: #aaa; }
        td { padding: 10px; border-bottom: 1px solid #444; }
        .status-badge { background: #33B26E; color: white; padding: 3px 8px; border-radius: 4px; font-size: 12px; }
        .loading { color: #ffca28; font-weight: bold; }
    </style>
</head>
<body>

    <div class="box">
        <h2>Onboarding Roster</h2>
        <div id="msg">System: <span class="loading">Connecting to Google SSOT...</span></div>
        
        <table>
            <thead>
                <tr>
                    <th>Candidate</th>
                    <th>Phone</th>
                    <th>Trade</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody id="rows">
                </tbody>
        </table>
    </div>

    <script>
        // YOUR SSOT DEPLOYMENT URL
        const ssotURL = "https://script.google.com/macros/s/AKfycbyHFv2lI2whyM63Y3Up_yqeI006GVOpVCgzQUDD8DvWXjdGVvqSkfCvL8wb8Ud8RIaG/exec";

        // 1. The function that handles the data
        function renderTable(data) {
            const tbody = document.getElementById('rows');
            const msg = document.getElementById('msg');
            
            if (!data || data.length < 2) {
                msg.innerHTML = "System: <span style='color:red'>Connected, but no data found.</span>";
                return;
            }

            msg.innerHTML = "System: <span style='color:#33B26E'>Live (Data Updated)</span>";
            tbody.innerHTML = ""; // Clear the loading row

            for (let i = 1; i < data.length; i++) {
                const row = data[i];
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${row[1] || '---'}</td>
                    <td>${row[2] || '---'}</td>
                    <td>${row[3] || '---'}</td>
                    <td><span class="status-badge">${row[5] || 'PENDING'}</span></td>
                `;
                tbody.appendChild(tr);
            }
        }

        // 2. The trigger that fetches the data
        const loader = document.createElement('script');
        loader.src = ssotURL + "?callback=renderTable";
        document.body.appendChild(loader);
    </script>
    // Example function to call your script from the Admin Portal
function electWorker(workerData) {
  fetch('YOUR_SCRIPT_URL', {
    method: 'POST',
    body: JSON.stringify({
      action: 'elect',
      folderId: workerData.folderId,
      email: workerData.email,
      name: workerData.name
    })
  })
  .then(res => res.json())
  .then(data => alert("Worker folder moved and Email Sent!"));
}
</body>
</html>
