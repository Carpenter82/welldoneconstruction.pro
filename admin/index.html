<script>
    const ssotURL = "https://script.google.com/macros/s/AKfycbyHFv2lI2whyM63Y3Up_yqeI006GVOpVCgzQUDD8DvWXjdGVvqSkfCvL8wb8Ud8RIaG/exec";

    function loadData() {
        const tbody = document.getElementById('tableBody');
        tbody.innerHTML = '<tr><td colspan="4">Fetching Roster...</td></tr>';

        // Create a temporary script tag (The JSONP trick)
        const script = document.createElement('script');
        script.src = `${ssotURL}?callback=renderTable`;
        document.body.appendChild(script);
    }

    // This function runs automatically when the data arrives
    function renderTable(data) {
        const tbody = document.getElementById('tableBody');
        tbody.innerHTML = '';

        if (!data || data.length < 2) {
            tbody.innerHTML = '<tr><td colspan="4">No workers found in spreadsheet.</td></tr>';
            return;
        }

        // Skip the header row (i=1)
        for (let i = 1; i < data.length; i++) {
            const row = data[i];
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${row[1] || '---'}</td>
                <td>${row[2] || '---'}</td>
                <td>${row[3] || '---'}</td>
                <td><span class="badge">${row[5] || 'PENDING'}</span></td>
            `;
            tbody.appendChild(tr);
        }
    }

    // Load data immediately on page open
    window.onload = loadData;
</script>
