<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WDC Quick Checklist</title>
    <style>
        body { font-family: -apple-system, sans-serif; padding: 20px; background-color: #f0f2f5; color: #1c1e21; }
        .card { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 8px 24px rgba(0,0,0,0.1); max-width: 450px; margin: auto; }
        h2 { color: #007bff; margin-bottom: 5px; }
        .sub-text { color: #65676b; margin-bottom: 25px; font-size: 0.9em; }
        .task { display: flex; align-items: center; background: #f8f9fa; padding: 15px; margin-bottom: 10px; border-radius: 8px; border: 1px solid #dee2e6; cursor: pointer; }
        input[type="checkbox"] { width: 20px; height: 20px; margin-right: 15px; }
        button { background: #007bff; color: white; border: none; padding: 18px; width: 100%; border-radius: 8px; font-size: 1.1em; font-weight: bold; cursor: pointer; margin-top: 10px; }
        button:disabled { background: #ccc; }
        #status { text-align: center; margin-top: 15px; font-weight: bold; }
    </style>
</head>
<body>
<div class="card">
    <h2>Quick Checklist</h2>
    <p id="empName" class="sub-text">Loading employee...</p>
    <div id="tasks">
        <label class="task"><input type="checkbox"> Start project on schedule</label>
        <label class="task"><input type="checkbox"> Materials/tools on-site</label>
        <label class="task"><input type="checkbox"> Work in progress photos sent</label>
        <label class="task"><input type="checkbox"> Project completed</label>
        <label class="task"><input type="checkbox"> Cleanup</label>
    </div>
    <button id="submitBtn" onclick="sendData()">Submit Checklist</button>
    <p id="status"></p>
</div>

<script>
    const urlParams = new URLSearchParams(window.location.search);
    const name = urlParams.get('employee') || "Worker";
    document.getElementById('empName').innerText = "Employee: " + name;

    async function sendData() {
        const btn = document.getElementById('submitBtn');
        const status = document.getElementById('status');
        btn.disabled = true;
        status.innerText = "Processing...";

        const checklistData = {
            employee: name,
            submittedAt: new Date().toLocaleString(),
            tasks: Array.from(document.querySelectorAll('.task')).map(t => ({
                taskName: t.innerText.trim(),
                done: t.querySelector('input').checked
            }))
        };

        // UPDATED WITH YOUR NEW URL:
        const scriptURL = "https://script.google.com/macros/s/AKfycbwImj4FnPHWpg1jWIo_Oh5dY0EiYVsficDcnWjmdz7t36e0ihIQnvXLrNk3lrG_JC8i/exec";

        try {
            await fetch(scriptURL, {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'text/plain' },
                body: JSON.stringify(checklistData)
            });
            status.innerText = "✅ Submission Saved!";
            status.style.color = "green";
        } catch (e) {
            status.innerText = "❌ Connection Error.";
            status.style.color = "red";
            btn.disabled = false;
        }
    }
</script>
</body>
</html>
