<!DOCTYPE html>
<html>
<head><link rel="stylesheet" href="../styles.css"><title>My Job</title></head>
<body>
<div class="container">
    <h2 id="w">Loading...</h2>
    <div id="j" style="display:none; border:2px solid #33B26E; padding:20px; border-radius:10px;">
        <h3>Current Job ID: <span id="id"></span></h3>
        <p>Location: <span id="loc"></span></p>
        <button onclick="window.open('https://www.google.com/maps/search/'+encodeURIComponent(document.getElementById('loc').innerText))">Get Directions</button>
    </div>
</div>
<script>
    const scriptURL = 'YOUR_DEPLOY_URL';
    const em = new URLSearchParams(window.location.search).get('email');
    async function load() {
        const r = await fetch(`${scriptURL}?action=getWorkerStatus&email=${em}`);
        const d = await r.json();
        if(d.status === 'Not Found') return alert("Record not found");
        document.getElementById('w').innerText = "Hello, " + d.name;
        if(d.jobId !== "UNASSIGNED") {
            document.getElementById('j').style.display = 'block';
            document.getElementById('id').innerText = d.jobId;
            document.getElementById('loc').innerText = d.details.address;
        }
    }
    window.onload = load;
</script>
</body>
</html>
