<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Worker Portal | Well Done Construction</title>
    <style>
        :root { --wd-green: #33B26E; --wd-dark: #343E47; --wd-bg: #F4F7F6; }
        body { font-family: 'Segoe UI', Arial, sans-serif; background-color: var(--wd-bg); color: var(--wd-dark); margin: 0; padding: 0; }
        
        /* Layout */
        .header { background: var(--wd-dark); color: white; padding: 20px; text-align: center; border-bottom: 5px solid var(--wd-green); }
        .container { max-width: 800px; margin: 20px auto; padding: 20px; }
        
        /* Profile Card */
        .card { background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .status-pill { display: inline-block; background: var(--wd-green); color: white; padding: 5px 15px; border-radius: 20px; font-size: 0.8rem; font-weight: bold; text-transform: uppercase; }
        
        /* Grid */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; }
        .grid-item { background: #fff; border: 1px solid #ddd; padding: 20px; border-radius: 6px; text-align: center; transition: 0.3s; cursor: pointer; text-decoration: none; color: inherit; }
        .grid-item:hover { border-color: var(--wd-green); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .grid-item h3 { margin: 0 0 10px 0; color: var(--wd-dark); }
        
        .payroll-notice { background: #fff3cd; color: #856404; padding: 15px; border-radius: 6px; border: 1px solid #ffeeba; margin-top: 20px; font-size: 0.9rem; }
        
        .footer { text-align: center; padding: 40px; color: #888; font-size: 0.8rem; }
    </style>
</head>
<body>

<div class="header">
    <h1>Well Done Construction</h1>
    <p>Official Worker Portal</p>
</div>

<div class="container">
    <div class="card">
        <div style="display: flex; justify-content: space-between; align-items: flex-start;">
            <div>
                <h2 style="margin: 0;">Worker Profile</h2>
                <p id="workerName" style="font-size: 1.2rem; margin: 10px 0;">Loading profile...</p>
            </div>
            <div class="status-pill">Active / Elected</div>
        </div>
        
        <div class="payroll-notice">
            <strong>Payroll Accountability:</strong> Please ensure all on-site tasks are checked off in your daily log to prevent processing delays.
        </div>
    </div>

    <div class="grid">
        <a href="https://welldoneconstruction.pro/portal/tasks" class="grid-item">
            <h3>Active Tasks</h3>
            <p>View your current job assignments and project goals.</p>
        </a>
        <a href="https://welldoneconstruction.pro/portal/payroll" class="grid-item">
            <h3>Payroll & Time</h3>
            <p>Review submitted hours and payment history.</p>
        </a>
        <a href="https://welldoneconstruction.pro/portal/resources" class="grid-item">
            <h3>Resources</h3>
            <p>Access safety manuals, trade guides, and W-2 forms.</p>
        </a>
        <a href="https://welldoneconstruction.pro/portal/profile" class="grid-item">
            <h3>Settings</h3>
            <p>Update your contact info or notification preferences.</p>
        </a>
    </div>
</div>

<div class="footer">
    &copy; 2026 Well Done Construction LLC | Integrity in Every Build
</div>

<script>
    const ssotURL = "https://script.google.com/macros/s/AKfycbyQKTJaxDQRa3Q4IFMhVp3MgSWnefqkqnv1biGDJ2jWexm_oZQzwLAyJxUmhpYAMddwDg/exec";

    function loadWorkerProfile() {
        const urlParams = new URLSearchParams(window.location.search);
        const workerEmail = urlParams.get('email');
        
        if (!workerEmail) {
            document.getElementById('workerName').innerText = "Guest User";
            return;
        }

        const script = document.createElement('script');
        script.src = `${ssotURL}?callback=handleProfile&email=${workerEmail}`;
        document.body.appendChild(script);
    }

    function handleProfile(data) {
        const emailToFind = new URLSearchParams(window.location.search).get('email');
        // Column 2 is Email (index 2), Column 1 is Name (index 1)
        const worker = data.find(row => row[2] === emailToFind);

        if (worker) {
            document.getElementById('workerName').innerText = worker[1]; 
        } else {
            document.getElementById('workerName').innerText = "Worker Not Found";
        }
    }

    window.onload = loadWorkerProfile;
</script>

</body>
</html>
